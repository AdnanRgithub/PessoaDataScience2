<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Applying the Central Limit Theorem - Data Science</title>
<meta name="description" content="Overseen by Dr. Luiz Pessoa.">
<meta name="generator" content="Hugo 0.53" />
<link href="/index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="/1/01/01/applying-the-central-limit-theorem/">
<link rel="stylesheet" href="/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="/js/functions.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="/js/jquery.backtothetop/jquery.backtothetop.min.js"></script></head>
<body>
<div class="container"><header>
<h1>Data Science</h1>

<p class="description">Overseen by Dr. Luiz Pessoa.</p>

</header>
<div class="menu">
<nav>
<ul>
<li><a href="/about/">About</a></li>
<li><a href="https://github.com/AdnanRgithub/PessoaDataScience2">GitHub</a></li>
<li><a href="https://LCE.umd.edu">Lab of Cognition &amp; Emotion</a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>Applying the Central Limit Theorem</h1>


<div id="an-example" class="section level2">
<h2>An example</h2>
<p>According the National Center for Health Statistics, the distribution of serum cholesterol levels for 20 to 74-year-old males living in the United States has mean 211 mg/dl, and a standard deviation of 46 mg/dl. We are planning to collect a sample of 25 individuals and measure their cholesterol levels.</p>
<p>We are interested in the following about the <em>sample</em>:</p>
<ol style="list-style-type: decimal">
<li>What is the probability that our <em>sample mean</em> will be above a certain limit, say 230?</li>
<li>What is the 95% confidence interval of our sample means?</li>
<li>How do these vary as we collect more samples? Does the probability increase or decrease? Does the size of the confidence interval increase or decrease? By what factor does it increase or decrease?</li>
<li>Finally, how large would the sample size have to be to ensure a 95% probability that the sample average is within 5 mg/dl of the population mean?</li>
</ol>
<p><em>How does the Central Limit Theorem (CLT) help us answer these questions?</em></p>
<hr />
</div>
<div id="central-limit-theorem" class="section level2">
<h2>Central Limit Theorem</h2>
<p>Given a population with a finite mean <span class="math inline">\(\mu\)</span> and a finite non-zero standard deviation <span class="math inline">\(\sigma\)</span>, the distribution of the sample means approaches a normal distribution as the sample size increases.</p>
<p>The mean of the sample means is given by</p>
<p><span class="math display">\[\mu_{\bar{X}} = \mu,\]</span></p>
<p>and the standard deviation of the sample means (also referred to as the <em>standard error of the mean</em>) is given by</p>
<p><span class="math display">\[\sigma_{\bar{X}} = \frac{\sigma}{\sqrt{N}}.\]</span></p>
<p>For a more precise version of CLT, please refer <a href="http://mathworld.wolfram.com/CentralLimitTheorem.html">Wolfram</a>.</p>
<p>An important observation is that no assumptions are made about the distribution of the parental population. It could be discrete or continuous, severely skewed, but as long as the mean and standard deviation are finite, CLT holds. To convince yourself of this, please take a look at examples <a href="http://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/BS704_Probability/BS704_Probability12.html">here</a> or use the simulator <a href="http://onlinestatbook.com/stat_sim/sampling_dist/index.html">here</a>.</p>
<hr />
</div>
<div id="samples" class="section level2">
<h2>Samples</h2>
<p>But what is a <strong>sample</strong>? We keep using that word, and its meaning is quite an important concept. <span style="color:magenta">A sample is a random draw of size N of data from the parent distribution.</span> We obtain a sample of data every time we randomly draw from what we conceptualize as the population of interest. If the population of interest in every student at UMD, then a random draw is obtained by any mechanism that (truly) randomly draws from it (think of an imaginary lottery machine that, after spinning it, we can obtain one student at a time).</p>
<p>And the <strong>sample mean</strong>? The sample mean is just the average of the measure of interest from the <span class="math inline">\(N\)</span> units that were sampled. So for each mean, we get exactly one sample mean.</p>
<p>When we’re thinking about the CLT (what it means), we need to think of repeating this process many times to have <u>multiple sample means</u>. Remember, that each sample has <span class="math inline">\(N\)</span> units. So for each mean, you need to sample a group of size <span class="math inline">\(N\)</span>. This is what the CLT talks about.</p>
<p>One reason this might appear confusing is that in any one given study, we only sample once (with size <span class="math inline">\(N\)</span>). That’s the world the experimenter lives in (except it she repeats her experiment). But that’s not the world of the CLT, which instead is a world in which we perform an experiment (a sample draw of size <span class="math inline">\(N\)</span>), over and over. And a few more times…</p>
<hr />
<p>Back to the previous questions. To answer them, it is essential to know the <em>sampling distribution</em>, that is, the <em>distribution</em> of the <u>sample mean</u>.</p>
<ul>
<li>Since the standard deviation of the parent population is known, from CLT it follows that the sampling distribution (<span class="math inline">\(N=25\)</span>) has a mean <span class="math inline">\(\mu_{\bar{X}} = 211\)</span> mg/dl, and standard deviation (this is called <strong>standard error</strong>) <span class="math inline">\(\sigma_{\bar{X}} = \frac{46}{\sqrt{25}} = 9.2.\)</span> Note that the standard error reduces as the number of samples increase by a factor <span class="math inline">\(\sqrt{N}.\)</span></li>
<li>Our limit, <span class="math inline">\(230\)</span> mg/dl, is therefore <span class="math inline">\(\frac{230 - 211}{9.2} = 2.07\)</span> standard deviations away from the mean. In other words, the z-score associated with the limit <span class="math inline">\(230\)</span> mg/dl is <span class="math inline">\(2.07\)</span>.</li>
</ul>
<ol style="list-style-type: decimal">
<li>The answer to our first question is simple the probability that a normally distributed random variable is greater than <span class="math inline">\(2.07\)</span> standard deviations away from the mean = <span class="math inline">\(1.9\%\)</span> (or <span class="math inline">\(0.019\)</span>).</li>
<li>For a normally distributed random variable, 95% of the values lie within 1.96 standard deviations of its mean (on either side). The standard deviation remains the same, <span class="math inline">\(9.2\)</span>. Thus, the <span class="math inline">\(95\%\)</span> confidence interval is simply, 211 - <span class="math inline">\(1.96(9.2) = 193.0\)</span> to <span class="math inline">\(211 + 1.96(9.2) = 229.0\)</span>.</li>
<li>Suppose we had only <span class="math inline">\(10\)</span> samples. Verify that the new standard error would be <span class="math inline">\(14.5\)</span> and the z-score associated with the limit, <span class="math inline">\(230\)</span> mg/dl, would be <span class="math inline">\(1.31\)</span>. The probability of our sample mean being over <span class="math inline">\(230\)</span> would thus be <span class="math inline">\(9.6\%\)</span> (almost <span class="math inline">\(5\)</span> times higher). On the other hand, our confidence interval would be much larger with <span class="math inline">\(10\)</span> samples; <span class="math inline">\((182.5, 239.5)\)</span>. How about if we had <span class="math inline">\(50\)</span> samples? This would result is a narrower confidence interval <span class="math inline">\((198.2, 223.8)\)</span> since the standard error is smaller.</li>
<li>To answer our final question, we need <span class="math inline">\(1.96\)</span> standard deviations of the sampling distribution to amount to <span class="math inline">\(5\)</span> mg/dl. Thus, the standard error should be <span class="math inline">\(\sigma_{\bar{X}} = \frac{\sigma}{\sqrt{N}} = 5/1.96.\)</span> Since, we know <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(N = 325.1\)</span>. We would need at least <span class="math inline">\(326\)</span> samples to ensure this confidence interval.</li>
</ol>
<hr />
</div>
<div id="hypothesis-testing" class="section level2">
<h2>Hypothesis Testing</h2>
<p>Thinking along these lines can be used to develop hypothesis tests and understand p-values. We start again with an example:</p>
<p>Cystic fibrosis is a genetic disease that affects lung function. Forced vital capacity (FVC) is the volume of air that a person can expel from the lungs in <span class="math inline">\(6\)</span> seconds. It is often used as a marker of the progression of cystic fibrosis. <span class="math inline">\(14\)</span> participants received both a drug and placebo (at different times), and their FVC was measured at the beginning and end of each treatment period. In the study, the mean difference in reduction in FVC (placebo - drug) was <span class="math inline">\(137\)</span>, with a <u>sample standard deviation</u> <span class="math inline">\(223\)</span>. Does the drug have a <em>significant</em> effect?</p>
<p>The null hypothesis is that the drug has no effect, thus the reduction in FVC should be zero. Let’s first find the probability of observing an FVC reduction of greater than <span class="math inline">\(137\)</span> given the null hypothesis.</p>
<p>We calculate the standard error based on the <span class="math inline">\(14\)</span> participants as <span class="math inline">\(\sigma_{\bar{X}} = \frac{223}{\sqrt{14}} = 60.\)</span> The z-score associated with the mean reduction in FVC is given by <span class="math inline">\(\frac{(137 - 0)}{60} = 2.28\)</span>. The probability of observing a value further from the mean by at least <span class="math inline">\(2.28\)</span> standard deviations, which is also the p-value, which is <span class="math inline">\(2.2\%\)</span> (or <span class="math inline">\(0.022\)</span>).</p>
<p>This is a small probability that the drug is having an effect just by chance. Why did we obtain a small probability? Because it’s effect by chance should be zero. But because we’re working with a sample (<span class="math inline">\(N=14\)</span>) that is randomly drawn from the population, the observed mean reduction will fluctuate from sample to sample. Based on data from our sample, the reduction was <span class="math inline">\(137\)</span>. But how large is <span class="math inline">\(137\)</span>? We don’t know without some form of calibration, which can be obtained by the information that was given to us: <span class="math inline">\(\sigma_{\bar{X}}\)</span>.</p>
<p>From these data, we can believe that the drug helps prevent deterioration in lung function. At least the data are consistent with this notion in a probabilistic sense. Another way to think about this, it would be somewhat irrational to think that we could obtain the observed result just by chance. Maybe not entirely with a p of basically <span class="math inline">\(\frac{2}{100}\)</span> but probably with a p of <span class="math inline">\(\frac{1}{1000}\)</span>. But obviously this is somewhat subjective.</p>
<hr />
</div>
<div id="the-flaw-in-the-z-test" class="section level2">
<h2>The flaw in the z-test</h2>
<p>Is the above reasoning correct? To understand this we need to understand the difference between the first and second examples.</p>
<p>In our first example, an <strong>oracle</strong> provided us with the standard deviation of the population. Some all-knowing being told us what the population <span class="math inline">\(\sigma\)</span> was. But in the second example the standard error was based on the sample. To make the distinction clear, we call the standard error based on sample data <span class="math inline">\(s_{\bar{X}}\)</span>.</p>
<p><u>Important aside</u>: why use the sample and not the population? Populations are essentially Platonic objects. We typically don’t have complete knowledge about the objects we want to study. If we did we wouldn’t need to study them in the first place! So we have to draw samples and do the best based on finite amounts of data. Another way to think about this is that oracles don’t walk around waiting to be interrogated. Maybe they were around in ancient Greece, but not anymore…</p>
<p>Gossett (which published under the pseudonym Student) showed that when the standard error is estimated from sample data, the statistic <span class="math inline">\(\frac{\bar{x} - \mu}{\sigma_{\bar{X}}}\)</span> is not normal, but follows a <em>t</em>-distribution with <span class="math inline">\(N - 1\)</span> degrees of freedom (df). The <em>t</em>-distribution looks very much like a normal, but has what we call heavier tails, that is, more mass along the tails relative to the normal.</p>
<p>Thus, the probability associated with a <em>t</em>-score of <span class="math inline">\(2.28\)</span> with <span class="math inline">\(14 - 1\)</span> degrees of freedom can be calculated to be <span class="math inline">\(4\%\)</span> (or <span class="math inline">\(0.04\)</span>). The p-value obtained from the z-test (<span class="math inline">\(2.2\%\)</span>) overstates the evidence against the null hypothesis (this is consistent with the fact that a normal is thinner along the tails than the <em>t</em>-distribution).</p>
<hr />
<p>Examples are borrowed from <a href="http://myweb.uiowa.edu/pbreheny/4120/s18/index.html">Introduction to Biostatistics</a> kindly offered by Patrick Breheny at UIowa.</p>
<p>Post by Manasij Venkatesh, with edits by L. Pessoa.</p>
</div>
<div class="edit-meta">Last updated on 1 Jan 0001 / Published on 1 Jan 0001<br></div><nav class="pagination"><a class="nav nav-prev" href="/post/" title="Posts"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Posts</a>
<a class="nav nav-next" href="/1/01/01/blog-how-can-we-do-data-analysis-when-theres-no-ground-truth/" title="Blog: How can we do data analysis when there&#39;s no &#34;ground truth&#34;?">Next - Blog: How can we do data analysis when there&#39;s no &#34;ground truth&#34;? <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main><div class="sidebar">
<nav>
<ul>
<li class=""><a href="/">Home</a></li>

<li class="parent"><a href="/post/">Posts</a>
<ul class="sub-menu">
<li class="active"><a href="/1/01/01/applying-the-central-limit-theorem/">Applying the Central Limit Theorem</a></li>
<li class=""><a href="/1/01/01/blog-how-can-we-do-data-analysis-when-theres-no-ground-truth/">Blog: How can we do data analysis when there&#39;s no &#34;ground truth&#34;?</a></li>
<li class=""><a href="/1/01/01/bootstrapping/">Bootstrapping</a></li>
<li class=""><a href="/1/01/01/finishing-submitting-a-paper-in-the-lab/">Finishing/submitting a paper in the lab</a></li>
<li class=""><a href="/1/01/01/multiple-regression/">Multiple regression</a></li>
<li class=""><a href="/1/01/01/permutation-testing/">Permutation Testing</a></li>
<li class=""><a href="/1/01/01/the-beauty-of-programming-via-probability-distributions-and-estimating-them/">The beauty of programming via probability distributions (and estimating them)</a></li>
<li class=""><a href="/1/01/01/the-magic-of-the-central-limit-theorem/">The magic of the central limit theorem</a></li>
<li class=""><a href="/1/01/01/understanding-data-overfitting-and-p-values/">Understanding data, overfitting, and p values</a></li>
</ul>
  
</li>
</ul>
</nav>


<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
